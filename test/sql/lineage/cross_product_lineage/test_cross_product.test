# name: test/sql/lineage/cross_product_lineage/test_cross_product.test
# description: Test Cross Product Lineage
# group: [cross_product_lineage]

statement ok
CREATE TABLE t1(i INTEGER, j INTEGER);

statement ok
CREATE TABLE t2(i INTEGER);

statement ok
INSERT INTO t1 SELECT i+1, i FROM range(0,5) tbl(i);
INSERT INTO t2 VALUES (1), (1000), (10)

statement ok
PRAGMA trace_lineage = "ON"

# standalone limit
query III
select t1.i, t1.j, t2.i from t1, t2
----
1	0	1
2	1	1
3	2	1
4	3	1
5	4	1
1	0	1000
2	1	1000
3	2	1000
4	3	1000
5	4	1000
1	0	10
2	1	10
3	2	10
4	3	10
5	4	10

statement ok
PRAGMA trace_lineage = "OFF";

query II
select query_id, query from queries_list;
----
11	select t1.i, t1.j, t2.i from t1, t2
13	PRAGMA trace_lineage = "OFF";

query III
SELECT rhs_rowid, rhs_in_chunk_id, out_chunk_id FROM CROSS_PRODUCT_11_0
----
0	0	0
1	0	1
2	0	2