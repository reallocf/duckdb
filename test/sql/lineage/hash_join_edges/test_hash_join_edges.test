# name: test/sql/lineage/hash_join/test_hash_join_edges.test
# description: Test Hash Joins Edge Cases
# group: [hash_join_edges]

statement ok
CREATE TABLE t1(i INTEGER);

# TODO this fails if second line second range value is to 2084... and it seems like lineage for last element isn't captured at 2083
statement ok
INSERT INTO t1 VALUES (0), (0), (0), (0), (0), (0), (0), (0), (0), (0), (0), (0), (0), (0), (0), (0), (0), (0), (0), (0), (0), (0), (0), (0), (0), (0), (0), (0), (0), (0), (0), (0), (0);
INSERT INTO t1 SELECT i FROM range(1030,1040) tbl(i);
INSERT INTO t1 VALUES (0);

statement ok
CREATE TABLE t2(i INTEGER);

statement ok
INSERT INTO t2 SELECT i FROM range(0,1030) tbl(i);
INSERT INTO t2 SELECT i FROM range(0,1030) tbl(i);
INSERT INTO t2 SELECT i FROM range(0,1030) tbl(i);

statement ok
PRAGMA enable_profiling;

statement ok
PRAGMA trace_lineage = "ON"

# test chunk merging
query II
select t1.i, t2.i from t1 inner join t2 on (t1.i = t2.i) where t1.i + t2.i = 0
----
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0

# test chunk splitting
query II
select l.i, r.i from t1 as l inner join t1 as r on (l.i = r.i) where l.i + r.i = 0
----
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0

query II
select query_id, query from queries_list;
----
1	select t1.i, t2.i from t1 inner join t2 on (t1.i = t2.i) where t1.i + t2.i = 0
2	select l.i, r.i from t1 as l inner join t1 as r on (l.i = r.i) where l.i + r.i = 0
3	select query_id, query from queries_list;


statement ok
PRAGMA trace_lineage = "OFF";

query III
select sink.in_index, probe.rhs_index, probe.out_index
from LINEAGE_1_HASH_JOIN_2_1 AS probe
join LINEAGE_1_HASH_JOIN_2_0 AS sink ON sink.out_address = probe.lhs_address;
----
43	0	0
32	0	1
31	0	2
30	0	3
29	0	4
28	0	5
27	0	6
26	0	7
25	0	8
24	0	9
23	0	10
22	0	11
21	0	12
20	0	13
19	0	14
18	0	15
17	0	16
16	0	17
15	0	18
14	0	19
13	0	20
12	0	21
11	0	22
10	0	23
9	0	24
8	0	25
7	0	26
6	0	27
5	0	28
4	0	29
3	0	30
2	0	31
1	0	32
0	0	33
43	1030	34
32	1030	35
31	1030	36
30	1030	37
29	1030	38
28	1030	39
27	1030	40
26	1030	41
25	1030	42
24	1030	43
23	1030	44
22	1030	45
21	1030	46
20	1030	47
19	1030	48
18	1030	49
17	1030	50
16	1030	51
15	1030	52
14	1030	53
13	1030	54
12	1030	55
11	1030	56
10	1030	57
9	1030	58
8	1030	59
7	1030	60
6	1030	61
5	1030	62
4	1030	63
3	1030	64
2	1030	65
1	1030	66
0	1030	67
43	2060	68
32	2060	69
31	2060	70
30	2060	71
29	2060	72
28	2060	73
27	2060	74
26	2060	75
25	2060	76
24	2060	77
23	2060	78
22	2060	79
21	2060	80
20	2060	81
19	2060	82
18	2060	83
17	2060	84
16	2060	85
15	2060	86
14	2060	87
13	2060	88
12	2060	89
11	2060	90
10	2060	91
9	2060	92
8	2060	93
7	2060	94
6	2060	95
5	2060	96
4	2060	97
3	2060	98
2	2060	99
1	2060	100
0	2060	101

# Confirm that the operator after a merge is handled correctly
query III
SELECT rowid, in_index, out_index FROM LINEAGE_1_FILTER_3_0
----
0	0	0
1	1	1
2	3	2
3	3	3
4	4	4
5	5	5
6	6	6
7	7	7
8	8	8
9	9	9
10	10	10
11	11	11
12	12	12
13	13	13
14	14	14
15	15	15
16	16	16
17	17	17
18	18	18
19	19	19
20	20	20
21	21	21
22	22	22
23	23	23
24	24	24
25	25	25
26	26	26
27	27	27
28	28	28
29	29	29
30	30	30
31	31	31
32	32	32
33	33	33
34	34	34
35	35	35
36	36	36
37	37	37
38	38	38
39	39	39
40	40	40
41	41	41
42	42	42
43	43	43
44	44	44
45	45	45
46	46	46
47	47	47
48	48	48
49	49	49
50	50	50
51	51	51
52	52	52
53	53	53
54	54	54
55	55	55
56	56	56
57	57	57
58	58	58
59	59	59
60	60	60
61	61	61
62	62	62
63	63	63
64	64	64
65	65	65
66	66	66
67	67	67
68	68	68
69	69	69
70	70	70
71	71	71
72	72	72
73	73	73
74	74	74
75	75	75
76	76	76
77	77	77
78	78	78
79	79	79
80	80	80
81	81	81
82	82	82
83	83	83
84	84	84
85	85	85
86	86	86
87	87	87
88	88	88
89	89	89
90	90	90
91	91	91
92	92	92
93	93	93
94	94	94
95	95	95
96	96	96
97	97	97
98	98	98
99	99	99
100	100	100
101	101	101

query III
select sink.in_index, probe.rhs_index, probe.out_index
from LINEAGE_2_HASH_JOIN_2_1 AS probe
join LINEAGE_2_HASH_JOIN_2_0 AS sink ON sink.out_address = probe.lhs_address;
----
43	0	0
43	1	1
43	2	2
43	3	3
43	4	4
43	5	5
43	6	6
43	7	7
43	8	8
43	9	9
43	10	10
43	11	11
43	12	12
43	13	13
43	14	14
43	15	15
43	16	16
43	17	17
43	18	18
43	19	19
43	20	20
43	21	21
43	22	22
43	23	23
43	24	24
43	25	25
43	26	26
43	27	27
43	28	28
43	29	29
43	30	30
43	31	31
43	32	32
33	33	33
34	34	34
35	35	35
36	36	36
37	37	37
38	38	38
39	39	39
40	40	40
41	41	41
42	42	42
43	43	43
32	0	44
32	1	45
32	2	46
32	3	47
32	4	48
32	5	49
32	6	50
32	7	51
32	8	52
32	9	53
32	10	54
32	11	55
32	12	56
32	13	57
32	14	58
32	15	59
32	16	60
32	17	61
32	18	62
32	19	63
32	20	64
32	21	65
32	22	66
32	23	67
32	24	68
32	25	69
32	26	70
32	27	71
32	28	72
32	29	73
32	30	74
32	31	75
32	32	76
32	43	77
31	0	78
31	1	79
31	2	80
31	3	81
31	4	82
31	5	83
31	6	84
31	7	85
31	8	86
31	9	87
31	10	88
31	11	89
31	12	90
31	13	91
31	14	92
31	15	93
31	16	94
31	17	95
31	18	96
31	19	97
31	20	98
31	21	99
31	22	100
31	23	101
31	24	102
31	25	103
31	26	104
31	27	105
31	28	106
31	29	107
31	30	108
31	31	109
31	32	110
31	43	111
30	0	112
30	1	113
30	2	114
30	3	115
30	4	116
30	5	117
30	6	118
30	7	119
30	8	120
30	9	121
30	10	122
30	11	123
30	12	124
30	13	125
30	14	126
30	15	127
30	16	128
30	17	129
30	18	130
30	19	131
30	20	132
30	21	133
30	22	134
30	23	135
30	24	136
30	25	137
30	26	138
30	27	139
30	28	140
30	29	141
30	30	142
30	31	143
30	32	144
30	43	145
29	0	146
29	1	147
29	2	148
29	3	149
29	4	150
29	5	151
29	6	152
29	7	153
29	8	154
29	9	155
29	10	156
29	11	157
29	12	158
29	13	159
29	14	160
29	15	161
29	16	162
29	17	163
29	18	164
29	19	165
29	20	166
29	21	167
29	22	168
29	23	169
29	24	170
29	25	171
29	26	172
29	27	173
29	28	174
29	29	175
29	30	176
29	31	177
29	32	178
29	43	179
28	0	180
28	1	181
28	2	182
28	3	183
28	4	184
28	5	185
28	6	186
28	7	187
28	8	188
28	9	189
28	10	190
28	11	191
28	12	192
28	13	193
28	14	194
28	15	195
28	16	196
28	17	197
28	18	198
28	19	199
28	20	200
28	21	201
28	22	202
28	23	203
28	24	204
28	25	205
28	26	206
28	27	207
28	28	208
28	29	209
28	30	210
28	31	211
28	32	212
28	43	213
27	0	214
27	1	215
27	2	216
27	3	217
27	4	218
27	5	219
27	6	220
27	7	221
27	8	222
27	9	223
27	10	224
27	11	225
27	12	226
27	13	227
27	14	228
27	15	229
27	16	230
27	17	231
27	18	232
27	19	233
27	20	234
27	21	235
27	22	236
27	23	237
27	24	238
27	25	239
27	26	240
27	27	241
27	28	242
27	29	243
27	30	244
27	31	245
27	32	246
27	43	247
26	0	248
26	1	249
26	2	250
26	3	251
26	4	252
26	5	253
26	6	254
26	7	255
26	8	256
26	9	257
26	10	258
26	11	259
26	12	260
26	13	261
26	14	262
26	15	263
26	16	264
26	17	265
26	18	266
26	19	267
26	20	268
26	21	269
26	22	270
26	23	271
26	24	272
26	25	273
26	26	274
26	27	275
26	28	276
26	29	277
26	30	278
26	31	279
26	32	280
26	43	281
25	0	282
25	1	283
25	2	284
25	3	285
25	4	286
25	5	287
25	6	288
25	7	289
25	8	290
25	9	291
25	10	292
25	11	293
25	12	294
25	13	295
25	14	296
25	15	297
25	16	298
25	17	299
25	18	300
25	19	301
25	20	302
25	21	303
25	22	304
25	23	305
25	24	306
25	25	307
25	26	308
25	27	309
25	28	310
25	29	311
25	30	312
25	31	313
25	32	314
25	43	315
24	0	316
24	1	317
24	2	318
24	3	319
24	4	320
24	5	321
24	6	322
24	7	323
24	8	324
24	9	325
24	10	326
24	11	327
24	12	328
24	13	329
24	14	330
24	15	331
24	16	332
24	17	333
24	18	334
24	19	335
24	20	336
24	21	337
24	22	338
24	23	339
24	24	340
24	25	341
24	26	342
24	27	343
24	28	344
24	29	345
24	30	346
24	31	347
24	32	348
24	43	349
23	0	350
23	1	351
23	2	352
23	3	353
23	4	354
23	5	355
23	6	356
23	7	357
23	8	358
23	9	359
23	10	360
23	11	361
23	12	362
23	13	363
23	14	364
23	15	365
23	16	366
23	17	367
23	18	368
23	19	369
23	20	370
23	21	371
23	22	372
23	23	373
23	24	374
23	25	375
23	26	376
23	27	377
23	28	378
23	29	379
23	30	380
23	31	381
23	32	382
23	43	383
22	0	384
22	1	385
22	2	386
22	3	387
22	4	388
22	5	389
22	6	390
22	7	391
22	8	392
22	9	393
22	10	394
22	11	395
22	12	396
22	13	397
22	14	398
22	15	399
22	16	400
22	17	401
22	18	402
22	19	403
22	20	404
22	21	405
22	22	406
22	23	407
22	24	408
22	25	409
22	26	410
22	27	411
22	28	412
22	29	413
22	30	414
22	31	415
22	32	416
22	43	417
21	0	418
21	1	419
21	2	420
21	3	421
21	4	422
21	5	423
21	6	424
21	7	425
21	8	426
21	9	427
21	10	428
21	11	429
21	12	430
21	13	431
21	14	432
21	15	433
21	16	434
21	17	435
21	18	436
21	19	437
21	20	438
21	21	439
21	22	440
21	23	441
21	24	442
21	25	443
21	26	444
21	27	445
21	28	446
21	29	447
21	30	448
21	31	449
21	32	450
21	43	451
20	0	452
20	1	453
20	2	454
20	3	455
20	4	456
20	5	457
20	6	458
20	7	459
20	8	460
20	9	461
20	10	462
20	11	463
20	12	464
20	13	465
20	14	466
20	15	467
20	16	468
20	17	469
20	18	470
20	19	471
20	20	472
20	21	473
20	22	474
20	23	475
20	24	476
20	25	477
20	26	478
20	27	479
20	28	480
20	29	481
20	30	482
20	31	483
20	32	484
20	43	485
19	0	486
19	1	487
19	2	488
19	3	489
19	4	490
19	5	491
19	6	492
19	7	493
19	8	494
19	9	495
19	10	496
19	11	497
19	12	498
19	13	499
19	14	500
19	15	501
19	16	502
19	17	503
19	18	504
19	19	505
19	20	506
19	21	507
19	22	508
19	23	509
19	24	510
19	25	511
19	26	512
19	27	513
19	28	514
19	29	515
19	30	516
19	31	517
19	32	518
19	43	519
18	0	520
18	1	521
18	2	522
18	3	523
18	4	524
18	5	525
18	6	526
18	7	527
18	8	528
18	9	529
18	10	530
18	11	531
18	12	532
18	13	533
18	14	534
18	15	535
18	16	536
18	17	537
18	18	538
18	19	539
18	20	540
18	21	541
18	22	542
18	23	543
18	24	544
18	25	545
18	26	546
18	27	547
18	28	548
18	29	549
18	30	550
18	31	551
18	32	552
18	43	553
17	0	554
17	1	555
17	2	556
17	3	557
17	4	558
17	5	559
17	6	560
17	7	561
17	8	562
17	9	563
17	10	564
17	11	565
17	12	566
17	13	567
17	14	568
17	15	569
17	16	570
17	17	571
17	18	572
17	19	573
17	20	574
17	21	575
17	22	576
17	23	577
17	24	578
17	25	579
17	26	580
17	27	581
17	28	582
17	29	583
17	30	584
17	31	585
17	32	586
17	43	587
16	0	588
16	1	589
16	2	590
16	3	591
16	4	592
16	5	593
16	6	594
16	7	595
16	8	596
16	9	597
16	10	598
16	11	599
16	12	600
16	13	601
16	14	602
16	15	603
16	16	604
16	17	605
16	18	606
16	19	607
16	20	608
16	21	609
16	22	610
16	23	611
16	24	612
16	25	613
16	26	614
16	27	615
16	28	616
16	29	617
16	30	618
16	31	619
16	32	620
16	43	621
15	0	622
15	1	623
15	2	624
15	3	625
15	4	626
15	5	627
15	6	628
15	7	629
15	8	630
15	9	631
15	10	632
15	11	633
15	12	634
15	13	635
15	14	636
15	15	637
15	16	638
15	17	639
15	18	640
15	19	641
15	20	642
15	21	643
15	22	644
15	23	645
15	24	646
15	25	647
15	26	648
15	27	649
15	28	650
15	29	651
15	30	652
15	31	653
15	32	654
15	43	655
14	0	656
14	1	657
14	2	658
14	3	659
14	4	660
14	5	661
14	6	662
14	7	663
14	8	664
14	9	665
14	10	666
14	11	667
14	12	668
14	13	669
14	14	670
14	15	671
14	16	672
14	17	673
14	18	674
14	19	675
14	20	676
14	21	677
14	22	678
14	23	679
14	24	680
14	25	681
14	26	682
14	27	683
14	28	684
14	29	685
14	30	686
14	31	687
14	32	688
14	43	689
13	0	690
13	1	691
13	2	692
13	3	693
13	4	694
13	5	695
13	6	696
13	7	697
13	8	698
13	9	699
13	10	700
13	11	701
13	12	702
13	13	703
13	14	704
13	15	705
13	16	706
13	17	707
13	18	708
13	19	709
13	20	710
13	21	711
13	22	712
13	23	713
13	24	714
13	25	715
13	26	716
13	27	717
13	28	718
13	29	719
13	30	720
13	31	721
13	32	722
13	43	723
12	0	724
12	1	725
12	2	726
12	3	727
12	4	728
12	5	729
12	6	730
12	7	731
12	8	732
12	9	733
12	10	734
12	11	735
12	12	736
12	13	737
12	14	738
12	15	739
12	16	740
12	17	741
12	18	742
12	19	743
12	20	744
12	21	745
12	22	746
12	23	747
12	24	748
12	25	749
12	26	750
12	27	751
12	28	752
12	29	753
12	30	754
12	31	755
12	32	756
12	43	757
11	0	758
11	1	759
11	2	760
11	3	761
11	4	762
11	5	763
11	6	764
11	7	765
11	8	766
11	9	767
11	10	768
11	11	769
11	12	770
11	13	771
11	14	772
11	15	773
11	16	774
11	17	775
11	18	776
11	19	777
11	20	778
11	21	779
11	22	780
11	23	781
11	24	782
11	25	783
11	26	784
11	27	785
11	28	786
11	29	787
11	30	788
11	31	789
11	32	790
11	43	791
10	0	792
10	1	793
10	2	794
10	3	795
10	4	796
10	5	797
10	6	798
10	7	799
10	8	800
10	9	801
10	10	802
10	11	803
10	12	804
10	13	805
10	14	806
10	15	807
10	16	808
10	17	809
10	18	810
10	19	811
10	20	812
10	21	813
10	22	814
10	23	815
10	24	816
10	25	817
10	26	818
10	27	819
10	28	820
10	29	821
10	30	822
10	31	823
10	32	824
10	43	825
9	0	826
9	1	827
9	2	828
9	3	829
9	4	830
9	5	831
9	6	832
9	7	833
9	8	834
9	9	835
9	10	836
9	11	837
9	12	838
9	13	839
9	14	840
9	15	841
9	16	842
9	17	843
9	18	844
9	19	845
9	20	846
9	21	847
9	22	848
9	23	849
9	24	850
9	25	851
9	26	852
9	27	853
9	28	854
9	29	855
9	30	856
9	31	857
9	32	858
9	43	859
8	0	860
8	1	861
8	2	862
8	3	863
8	4	864
8	5	865
8	6	866
8	7	867
8	8	868
8	9	869
8	10	870
8	11	871
8	12	872
8	13	873
8	14	874
8	15	875
8	16	876
8	17	877
8	18	878
8	19	879
8	20	880
8	21	881
8	22	882
8	23	883
8	24	884
8	25	885
8	26	886
8	27	887
8	28	888
8	29	889
8	30	890
8	31	891
8	32	892
8	43	893
7	0	894
7	1	895
7	2	896
7	3	897
7	4	898
7	5	899
7	6	900
7	7	901
7	8	902
7	9	903
7	10	904
7	11	905
7	12	906
7	13	907
7	14	908
7	15	909
7	16	910
7	17	911
7	18	912
7	19	913
7	20	914
7	21	915
7	22	916
7	23	917
7	24	918
7	25	919
7	26	920
7	27	921
7	28	922
7	29	923
7	30	924
7	31	925
7	32	926
7	43	927
6	0	928
6	1	929
6	2	930
6	3	931
6	4	932
6	5	933
6	6	934
6	7	935
6	8	936
6	9	937
6	10	938
6	11	939
6	12	940
6	13	941
6	14	942
6	15	943
6	16	944
6	17	945
6	18	946
6	19	947
6	20	948
6	21	949
6	22	950
6	23	951
6	24	952
6	25	953
6	26	954
6	27	955
6	28	956
6	29	957
6	30	958
6	31	959
6	32	960
6	43	961
5	0	962
5	1	963
5	2	964
5	3	965
5	4	966
5	5	967
5	6	968
5	7	969
5	8	970
5	9	971
5	10	972
5	11	973
5	12	974
5	13	975
5	14	976
5	15	977
5	16	978
5	17	979
5	18	980
5	19	981
5	20	982
5	21	983
5	22	984
5	23	985
5	24	986
5	25	987
5	26	988
5	27	989
5	28	990
5	29	991
5	30	992
5	31	993
5	32	994
5	43	995
4	0	996
4	1	997
4	2	998
4	3	999
4	4	1000
4	5	1001
4	6	1002
4	7	1003
4	8	1004
4	9	1005
4	10	1006
4	11	1007
4	12	1008
4	13	1009
4	14	1010
4	15	1011
4	16	1012
4	17	1013
4	18	1014
4	19	1015
4	20	1016
4	21	1017
4	22	1018
4	23	1019
4	24	1020
4	25	1021
4	26	1022
4	27	1023
4	28	1024
4	29	1025
4	30	1026
4	31	1027
4	32	1028
4	43	1029
3	0	1030
3	1	1031
3	2	1032
3	3	1033
3	4	1034
3	5	1035
3	6	1036
3	7	1037
3	8	1038
3	9	1039
3	10	1040
3	11	1041
3	12	1042
3	13	1043
3	14	1044
3	15	1045
3	16	1046
3	17	1047
3	18	1048
3	19	1049
3	20	1050
3	21	1051
3	22	1052
3	23	1053
3	24	1054
3	25	1055
3	26	1056
3	27	1057
3	28	1058
3	29	1059
3	30	1060
3	31	1061
3	32	1062
3	43	1063
2	0	1064
2	1	1065
2	2	1066
2	3	1067
2	4	1068
2	5	1069
2	6	1070
2	7	1071
2	8	1072
2	9	1073
2	10	1074
2	11	1075
2	12	1076
2	13	1077
2	14	1078
2	15	1079
2	16	1080
2	17	1081
2	18	1082
2	19	1083
2	20	1084
2	21	1085
2	22	1086
2	23	1087
2	24	1088
2	25	1089
2	26	1090
2	27	1091
2	28	1092
2	29	1093
2	30	1094
2	31	1095
2	32	1096
2	43	1097
1	0	1098
1	1	1099
1	2	1100
1	3	1101
1	4	1102
1	5	1103
1	6	1104
1	7	1105
1	8	1106
1	9	1107
1	10	1108
1	11	1109
1	12	1110
1	13	1111
1	14	1112
1	15	1113
1	16	1114
1	17	1115
1	18	1116
1	19	1117
1	20	1118
1	21	1119
1	22	1120
1	23	1121
1	24	1122
1	25	1123
1	26	1124
1	27	1125
1	28	1126
1	29	1127
1	30	1128
1	31	1129
1	32	1130
1	43	1131
0	0	1132
0	1	1133
0	2	1134
0	3	1135
0	4	1136
0	5	1137
0	6	1138
0	7	1139
0	8	1140
0	9	1141
0	10	1142
0	11	1143
0	12	1144
0	13	1145
0	14	1146
0	15	1147
0	16	1148
0	17	1149
0	18	1150
0	19	1151
0	20	1152
0	21	1153
0	22	1154
0	23	1155
0	24	1156
0	25	1157
0	26	1158
0	27	1159
0	28	1160
0	29	1161
0	30	1162
0	31	1163
0	32	1164
0	43	1165

# Confirm that the operator after a split is handled correctly TODO: this seems quite close - but still not entirely correct
query III
SELECT rowid, in_index, out_index FROM LINEAGE_2_FILTER_3_0
----
