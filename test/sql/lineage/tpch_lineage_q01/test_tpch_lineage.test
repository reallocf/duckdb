# name: test/sql/lineage/tpch_lineage/test_tpch_lineage.test
# description: Test TPCH Q01 Lineage
# group: [tpch_lineage_q01]

require tpch

statement ok
CALL dbgen(sf=0.001);

statement ok
PRAGMA enable_profiling;
PRAGMA trace_lineage = "ON";

query I
SELECT
    sum(l_extendedprice) / 7.0 AS avg_yearly
FROM
    lineitem,
    part
WHERE
    p_partkey = l_partkey
    AND p_container = 'MED BOX'
    AND l_quantity < (
        SELECT
            0.2 * avg(l_quantity)
        FROM
            lineitem
        WHERE
            l_partkey = p_partkey);
----

statement ok
PRAGMA trace_lineage = "OFF";
PRAGMA disable_profiling;



query III
select * from LINEAGE_1_PERFECT_HASH_GROUP_BY_3_1;
----

