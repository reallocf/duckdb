# name: test/sql/lineage/filter_lineage/test_filter_lineage.test
# description: Test Filter Lineage
# group: [filter_lineage]


statement ok
PRAGMA explain_output = PHYSICAL_ONLY;

statement ok
CREATE TABLE t1(i INTEGER);

statement ok
INSERT INTO t1 SELECT i FROM range(0,2000) tbl(i);

statement ok
PRAGMA trace_lineage = "ON";

query I
select * from t1 where 2 > i  OR i > 1998
----
0
1
1999

statement ok
PRAGMA trace_lineage = "OFF";

query II
SELECT * FROM queries_list;
----
9	select * from t1 where 2 > i  OR i > 1998
11	PRAGMA trace_lineage = "OFF";

query IIII
SELECT rowid, in_index, out_index, out_chunk_id FROM FILTER_9_0
----
0	0	0	0
1	1	1	0
2	975	0	1


query IIIIII
SELECT rowid, filter_exists, in_chunk_id, in_index, out_index, out_chunk_id FROM SEQ_SCAN_9_1
----
0	False	0	0	0	0
1	False	1	0	0	1