# name: test/sql/lineage/inmemory_lineage_query/test_bw_cross_product.test
# description: Test Cross Product Lineage
# group: [inmemory_lineage_query]

statement ok
CREATE TABLE t1(i INTEGER);

statement ok
CREATE TABLE t2(i INTEGER);

statement ok
INSERT INTO t1 SELECT i FROM range(0,1025) tbl(i);
INSERT INTO t2 SELECT i FROM range(0,1025) tbl(i);

statement ok
PRAGMA trace_lineage = "ON"

# standalone limit
statement ok
select t1.rowid, t2.rowid, t1.i, t2.i from t1, t2


statement ok
PRAGMA trace_lineage = "OFF";

query I
PRAGMA lineage_query('select t1.rowid, t2.rowid, t1.i, t2.i from t1, t2', 0, 'LIN', 0)
----
[0, 0]

query I
PRAGMA lineage_query('select t1.rowid, t2.rowid, t1.i, t2.i from t1, t2', 1, 'LIN', 0)
----
[1, 0]

query I
PRAGMA lineage_query('select t1.rowid, t2.rowid, t1.i, t2.i from t1, t2', 1024, 'LIN', 0)
----
[0, 1]

query I
PRAGMA lineage_query('select t1.rowid, t2.rowid, t1.i, t2.i from t1, t2', 1050624, 'LIN', 0)
----
[1024, 1024]